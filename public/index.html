<!-- HTML 5 Doctype -->
<!DOCTYPE html>

<!-- The “no-js” class will be automatically removed if JavaScript is
 - available.
 -->
<html lang="en" dir="ltr" class="no-js">

<head>
	<meta charset="utf-8" />
<!--
 - This file is a part of Xen Orchestra Web.
 -
 - Xen Orchestra Web is free software: you can redistribute it and/or
 - modify it under the terms of the GNU Affero General Public License
 - as published by the Free Software Foundation, either version 3 of
 - the License, or (at your option) any later version.
 -
 - Xen Orchestra Web is distributed in the hope that it will be
 - useful, but WITHOUT ANY WARRANTY; without even the implied warranty
 - of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
 - Affero General Public License for more details.
 -
 - You should have received a copy of the GNU Affero General Public License
 - along with Xen Orchestra Web. If not, see
 - <http://www.gnu.org/licenses/>.
 -
 - @author Olivier Lambert <olivier.lambert@vates.fr>
 - @license http://www.gnu.org/licenses/agpl-3.0-standalone.html GNU AGPLv3
 -
 - @package Xen Orchestra Web
 -->

	<!-- Makes sure IE is using the last engine available. -->
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

	<!-- Replaces the “no-js” class by the “js” class if JavaScript
	 - is available.
	 -->
	<script>!function(d){d.className=d.className.replace(/\bno-js\b/,'js')}(document.documentElement)</script>

	<!-- HTML5 shim, for IE6-8 support of HTML5 elements. -->
	<!--[if lt IE 9]>
		<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->

	<!-- (To confirm.) For smartphones and tablets: sets the page
	 - width to the device width and prevents the page from being
	 - zoomed in when going to landscape mode.
	 -->
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />

	<title>Xen Orchestra</title>

	<meta name="description" content="Web Interface for XCP" />
	<meta name="author" content="Olivier Lambert and Julien Fontanet" />

	<!-- We use Bootstrap CSS. -->
	<link rel="stylesheet" href="./css/bootstrap.css" />

	<!-- This font is used for icons. -->
	<link rel="stylesheet" href="./css/font-awesome.css" />

	<!-- Our stylesheet and scripts. -->
	<link rel="stylesheet" href="./css/style.css" />
	<link rel="icon" type="image/png" href="./img/favicon.png" />
</head>

<body>
	<div class="navbar navbar-fixed-top">
		<div class="navbar-inner">
			<div class="container">
				<a id="tour_home" class="brand" href="#">
					<img src="./img/bannerb.png" alt="Xen Orchestra" />
				</a>
				<a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</a>
				<div class="nav-collapse collapse">
					<ul class="nav">
						<li class="divider-vertical"></li>
						<li id="tour_host" class="dropdown">
							<a class="dropdown-toggle" data-toggle="dropdown" href="#"><i class="icon-cloud"></i> Server <b class="icon-caret-down"></b></a>
							<ul class="dropdown-menu" role="menu">
								<li><a href="#hosts"><i class="icon-reorder"></i> List</a></li>
								<li><a href="#modal-new-server" data-toggle="modal"><i class="icon-plus"></i> Add...</a></li>
							</ul>
						</li>
						
						<li id="tour_vm">
							<a href="#vms"><i class="icon-desktop"></i> Vm</a>
						</li>
						<!--<li id="tour_misc" class="dropdown">
							<a class="dropdown-toggle" data-toggle="dropdown" href="#">
								<i class="icon-cog"></i> Misc <b class="icon-caret-down"></b>
							</a>
							<ul class="dropdown-menu">-->
								<li><a href="#templates"><i class="icon-file-alt"></i> Template</a></li>
								<li><a href="#storages"><i class="icon-hdd"></i> Storage</a></li>
								<li><a href="#networks"><i class="icon-sitemap"></i> Network</a></li>
								<!--@todo <li class="disabled"><a href="#"><i class="icon-comment"></i> Logs</a></li>
								<li class="divider"></li>
							<li class="disabled"><a href="#"><i class="icon-asterisk"></i> Other</a></li>-->
							<!--</ul>-->
					</ul>
					<ul class="nav pull-right">
						<li class="divider-vertical"></li>
						<li id="tour_setting">
							<a title="Settings" href="#admin"><i class="icon-wrench"></i></a>
						</li>
						<li class="disabled">
							<a id="msg" href="#"><i class="icon-bell"></i></a>
						</li>

<!--
 - Session.
 -->
<!-- {if $user}
	<li>
		<a title="My profile" href="#"><i class="icon-user"></i> {$user}</a>
	</li>
	<li>
		<a title="Log-Out" href="{url controller="home" action="session"}"> <i class="icon-signout"></i></a>
	</li>
{else} -->
	<li id="tour_login" class="dropdown">
		<a class="dropdown-toggle" href="#" data-toggle="dropdown">
			<i class="icon-signin"></i> Log In <i class="icon-caret-down"></i>
		</a>
		<div class="dropdown-menu" style="padding: 15px; padding-bottom: 0px;">
			<form action="#/home/session" method="post">
				<div class="input-prepend">
					<span class="add-on"><i class="icon-user"></i></span>
					<input class="span2" type="text" placeholder="User" name="name" required />
				</div>
				<div class="input-prepend">
						<span class="add-on"><i class="icon-key"></i></span>
					<input class="span2" type="password" placeholder="Password" name="password" required /><br /><br />
				</div>
				<button type="submit" class="btn btn-primary">
					<i class="icon-signin icon-small"></i> Log In
				</button>
			</form>
		</div>
	</li>
<!-- {/if} -->

					</ul>

					<form id="tour_search" class="input-prepend navbar-search pull-right navbar-search" action="post">
						<span class="add-on"><i class="icon-search"></i></span>
						<input type="text" class="span2 inputIcon" placeholder="Search" disabled/>
					</form>
				</div><!-- /.nav-collapse -->
			</div><!-- /.container -->
		</div><!-- /.navbar-inner -->
	</div><!-- /.navbar -->

	<!--==============================================================
	 = Regions.
	 ==============================================================-->

	<!-- Main content region -->
	<div id="reg-main"></div>
	
	<!--==============================================================
	 = Modal Windows.
	 ==============================================================-->
	
	<div class="modal fade" id="modal-new-server">
		<div class="modal-header">
			<a class="close" data-dismiss="modal">&times;</a>
			<h3>Add a new server or pool</h3>
		</div>
		<div class="modal-body">
			<form class="input-prepend">
				<div class="form-group">
					<span class="add-on"><i class="icon-cloud"></i></span><input type="text" class="form-control" id="host" placeholder="Enter hostname or IP address">
				</div>
				<br/>
				<div class="form-group">
					<span class="add-on"><i class="icon-user"></i></span><input type="text" class="form-control" id="user" placeholder="Enter user">
				</div>
				<div class="form-group">
					<span class="add-on"><i class="icon-key"></i></span><input type="password" class="form-control" id="user" placeholder="Enter password">
				</div>
			</form>
		</div>
		<div class="modal-footer">
			<a href="#" class="btn" data-dismiss="modal">Close</a>
			<a href="#" class="btn btn-primary">Save Changes</a>
		</div>
	</div>
	
	<!--==============================================================
	 = Templates.
	 ==============================================================-->
	 
	 
	<!-- Home page with the statistics. -->
	<script type="text/template" id="tpl-stats">
		<div class="row-fluid">
			<div class="span10 offset1 hero-unit">
				<h2 class="center">XO Dashboard</h2>

				<div class="row-fluid offset1">
					<div class="row-fluid span3 center">
						<h2>
							<%= hosts %>x
							<a href="#hosts"><i class="icon-cloud icon-2x"></i></a>
						</h2>
						<p>hosts running</p>
					</div>
					<div class="row-fluid span3 center">
						<h2>
							<%= running_vms %>x
							<a href="#vms"><i class="icon-desktop icon-2x"></i></a>
						</h2>
						<p>of <%= vms %> VMs running</p>
					</div>
					<div class="row-fluid span3 center">
						<h2>
							<%= srs %>x
							<a href="#storages"><i class="icon-hdd icon-2x"></i></a>
						</h2>
						<p>shared repositories</p>
					</div>
				</div>

				<div class="row-fluid offset1">
					<div class="row-fluid span3 center">
						<h2>
							<%= vcpus %>x
							<i class="icon-dashboard icon-2x"></i>
						</h2>
						<p>vCPUs used</p>
					</div>
					<div class="row-fluid span3 center">
						<h2>
							<%= formatSize(memory) %>
							<i class="icon-tasks icon-2x"></i>
						</h2>
						<p>of RAM allocated</p>
					</div>
					<div class="row-fluid span3 center">
						<h2>
							<%= vifs %>x
							<i class="icon-sitemap icon-2x"></i>
						</h2>
						<p>virtual interfaces up</p>
					</div>
				</div>
				<br/><br/>
				<p class="center"><a type="button" class="btn btn-success btn-large start" href="#new_host" data-toggle="modal"><i class="icon-plus-sign"></i> Add a new host</a></p>
				
			</div>
		</div>

		<div class="row-fluid">
			<div class="span3 well offset1">
				<h2 class="center">Need help?</h2>
				<p>If you don't know how to start, please read the README first. Then, if you have further questions, please read the FAQ on the project website.
				</p><br/>
				<p class="center"><a class="btn btn-info btn-large start" href="https://github.com/vatesfr/xo/blob/master/README.md" ><i class="icon-info-sign"></i> Readme</a></p>
			</div>
			<div class="span4 well">
				<h2 class="center">About us</h2>
				<p>We are the team behind XO, we are Vates! We create Open Source products and we offer commercial support for Xen and Xen Orchestra. This project is Open Source (AGPL), everyone is welcome aboard!</p><br/>
				<p class="center"><a class="btn btn-large" href="http://vates.fr"><i class="icon-circle-arrow-right"></i> Go on our website!</a></p>
			</div>
			<div class="span3 well">
				<h2 class="center">Get involved!</h2>
				<p>You want a specific feature in XO? Report a bug? Go to our project website, read the FAQ and get involved in the project!</p><br/>
				<p class="center"><a class="btn btn-success btn-large" href="http://xen-orchestra.com"><i class="icon-beaker"></i> Project page</a></p>
			</div>
		</div>
	</script>

	<!-- Hosts list. -->
	<script type="text/template" id="tpl-hosts-list" data-class="container" data-items-container="tbody">
		<h3 class="center"><%= link(name_label, ['pools', uuid]) %></h3>

		<table class="table table-bordered table-hover table-striped">
			<thead>
				<th>Name</th>
				<th>Description</th>
				<th>Memory</th>
				<th>Addresses</th>
				<th>Uptime</th>
			</thead>
			<tbody></tbody>
		</table>
	</script>
	<script type="text/template" id="tpl-hosts-list-item" data-tag="tr">
		<td><%= link(name_label, ['hosts', uuid]) %></td>
		<td><%= name_description %></td>
		<td><%= progressBar(
			- 100 * metrics.memory_free / metrics.memory_total,
			{
				'title': formatSize(metrics.memory_free) +' of '+ formatSize(metrics.memory_total)
			}
		) %></td>
		<td><%= '@todo' || (IPs.length ? IPs.join(', ') : '<em>none</em>') %></td><!-- @todo -->
		<td><%= '@todo' || formatDuration_fromNow(start_time) %></td>
	</script>

	<!-- Host. -->
	<script type="text/template" id="tpl-host" data-class="container well" data-items-container=".tab-content">
		<h3 class="center"><%= name_label %></h3>

		<!-- Tabs menu. -->
		<ul class="nav nav-tabs">
			<li class="active"><a href="#general"><i class="icon-home"></i> General</a></li>
			<li><a href="#memory"><i class="icon-tasks"></i> Memory</a></li>
			<li><a href="#storage"><i class="icon-hdd"></i> Storage</a></li>
			<li><a href="#network"><i class="icon-sitemap"></i> Network</a></li>
			<!-- @todo
			<li class="dropdown">
				<a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="icon-cog"></i> Misc <b class="caret"></b></a>
				<ul class="dropdown-menu">
					<li><a href="#console"><i class="icon-desktop"></i> Console</a></li>
					<li><a href="#perfs"><i class="icon-bar-chart"></i> Perfs</a></li>
					<li><a href="#alerts"><i class="icon-bullhorn"></i> Alerts</a></li>
					<li><a href="#logs"><i class="icon-comment"></i> Logs</a></li>
					<li><a href="#other"><i class="icon-asterisk"></i> Other</a></li>
				</ul>
			</li> -->
		</ul>

		<div class="tab-content"></ul>
	</script>
	<script type="text/template" id="tpl-host-general" data-class="tab-pane fade in active" data-id="general">
		<dl class="dl-horizontal">
			<dt>Name:</dt><dd><%= name_label %></dd>
			<dt>Description:</dt><dd><%= name_description || '<em>none</em>' %></dd>
			<dt>Pool master:</dt><dd><%= '@todo' || yesNo(is_pool_master) %></dd>
			<dt>Enabled:</dt><dd><%= yesNo(enabled) %></dd>
			<dt>iSCSI IQN:</dt><dd><%= '@todo' || iscsi_iqn || '<em>none</em>' %></dd>
			<dt>OS:</dt><dd><%= '@todo' || os_version || '<em>none</em>' %></dd>
			<dt>Log destination:</dt><dd><%= '@todo' || log_destination %></dd>
			<dt>Server uptime:</dt><dd><%= false && start_time ? formatDuration_fromNow(start_time) : '<i>N/A</i>' %></dd>
			<dt>Toolstack uptime:</dt><dd><%= '@todo' || (tool_stack_start_time ? formatDuration_fromNow(tool_stack_start_time) : '<i>N/A</i>') %></dd>
			<dt>UUID:</dt><dd><%= uuid %></dd>
		</dl>

		<dl class="dl-horizontal">
			<dt>Hostname:</dt><dd><%= hostname %></dd>
			<% for (var i = 0; i < PIFs.length; ++i)
			{
				var PIF = PIFs[i];
				%><dt><%= PIF.name %></dt><dd><%= PIF.IP || '<i>no address</i>' %></dd><%
			} %>
		</dl>

		<dl class="dl-horizontal">
			<dt>XCP version:</dt><dd><%= software_version.platform_version %></dd>
		</dl>

		<dl class="dl-horizontal">
			<% for (var i = 0; i < host_CPUs.length; ++i)
			{
				var CPU = host_CPUs[i];
				%><dt>CPU #<%= i + 1 %>:</dt>
				<dd>
					<%= CPU.number %>×
					<%= CPU.vendor %>
					<%= CPU.model_name %>
					<%= CPU.model %>
					@ <%= CPU.speed %>
					<%= CPU.vendor %>
				</dd><%
			} %>
		</dl>
	</script>
	<script type="text/template" id="tpl-host-memory" data-class="tab-pane fade" data-id="memory">
		<div class="progress progress-big progress-danger">
			<%
			var size_per_VM = _.clone(memory.per_VM);
			size_per_VM.free = memory.free;
			size_per_VM = xo.plop(size_per_VM, 0.5, 100);
			for (var VM_uuid in memory.per_VM)
			{
				var VM     = VMs[VM_uuid];
				var VM_mem = formatSize(memory.per_VM[VM_uuid]);
				var size   = size_per_VM[VM_uuid];
				if ('dom0' === VM_uuid )
				{
					%><div class="bar bar-info" style="width: <%= size %>%;">
						<%= VM.name %><br/>
						(<%= VM_mem %>)
					</div><%
				}
				else
				{
					%><div class="bar" style="width: <%= size %>%;">
						<%= link(VM.name, ['vms', VM_uuid]) %><br/>
						(<%= VM_mem %>)
					</div><%
				}
			} %>
		</div>
		<dl class="dl-horizontal">
			<dt>Total memory:</dt><dd><%= formatSize(memory.total) %></dd>
			<dt>Currently used:</dt><dd><%= formatSize(memory.total-memory.free) %></dd>
			<dt>Available memory:</dt><dd><%= formatSize(memory.free) %></dd>
		</dl>
	</script>
	<script type="text/template" id="tpl-host-storage" data-class="tab-pane fade" data-id="storage" data-items-container="tbody">
		<table class="table table-hover table-condensed">
			<thead>
				<tr>
					<th>Name</th>
					<th>Description</th>
					<th>Type</th>
					<th>Shared</th>
					<th>Usage</th>
					<th>Size</th>
					<th>Allocated</th>
				</tr>
			</thead>
			<tbody>
			<% for (var i = 0; i < SRs.length; ++i)
			{
				var SR = SRs[i];
				%><tr>
					<td><i class="icon-hdd"></i> <%= SR.name %></td>
					<td><%= SR.description %></td>
					<td><%= SR.type %></td>
					<td><%= SR.shared ? 'Yes' : 'No' %></td>
					<td><%= Math.round(100*SR.used/SR.total) %>% (<%= formatSize(SR.used) %> used)</td>
					<td><%= formatSize(SR.total) %></td>
					<td><%= formatSize(SR.allocated) %></td>
				</tr><%
			} %>
			</tbody>
		</table>
	</script>
	<script type="text/template" id="tpl-host-network" data-class="tab-pane fade" data-id="network" data-items-container="tbody">
		<table class="table table-hover table-condensed">
			<thead>
				<tr>
					<th>Name</th>
					<th>Speed</th>
					<th>Duplex</th>
					<th>IP</th>
					<th>MAC</th>
					<th>Hardware</th>
					<th>Link status</th>
				</tr>
			</thead>
			<tbody>
			<% for (var i = 0; i < PIFs.length; ++i)
			{
				var PIF = PIFs[i];
				%><tr>
					<td><i class="icon-sitemap"></i> <%= PIF.name %></td>
					<td><%= PIF.speed %></td>
					<td><%= PIF.duplex ? 'Yes' : 'No' %></td>
					<td><%= PIF.IP ? PIF.IP : '<em>none</em>' %></td>
					<td class="mac-address"><%= PIF.MAC %></td>
					<td><%= PIF.vendor %> <%= PIF.device %></td>
					<td><%
					if (PIF.currently_attached)
					{
						%><span class="label label-success">Connected</span></td><%
					}
					else
					{
						%><span class="label label-important">Not connected</span></td><%
					} %>
				</tr><%
			} %>
			</tbody>
		</table>
	</script>
	<!-- <script type="text/template" id="tpl-host-console" data-class="tab-pane fade" data-id="console">
		@todo
	</script> -->
	<!-- <script type="text/template" id="tpl-host-perfs" data-class="tab-pane fade" data-id="perfs">
		@todo
	</script> -->
	<!-- <script type="text/template" id="tpl-host-alert" data-class="tab-pane fade" data-id="alert">
		@todo
	</script> -->
	<!-- <script type="text/template" id="tpl-host-other" data-class="tab-pane fade" data-id="other">
		@todo
		<dl class="dl-horizontal">
			<dt>Multipathing:</dt>
			<dd>None</dd>
			<dt>Log destination:</dt>
			<dd>Local</dd>
			<dt>Power On:</dt>
			<dd>Disabled</dd>
		</dl>
	</script> -->
	<!-- <script type="text/template" id="tpl-host-logs" data-class="tab-pane fade" data-id="logs">
		@todo
		<table class="table table-hover table-condensed">
			<thead>
				<tr>
					<th>Event name</th>
					<th>Details</th>
					<th>Date</th>
					<th>Time</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td><i class="icon-comment"></i> Shutting down</td>
					<td>User canceled</td>
					<td>15.3.2011 18:29:34</td>
					<td>00:10:16</td>
				</tr>
				<tr>
					<td><i class="icon-comment"></i> Shutting down</td>
					<td>User canceled</td>
					<td>15.3.2011 18:29:22</td>
					<td>00:10:16</td>
				</tr>
			</tbody>
		</table>
	</script> -->

	<!-- VMs list. -->
	<script type="text/template" id="tpl-vms-list" data-class="container" data-items-container="tbody">
		<h3 class="center"><%= uuid
			? link(name_label, ['hosts', uuid])
			: 'No host' %></h3>
		<table class="table table-bordered table-hover table-striped">
			<thead>
				<th>Name</th>
				<th>Description</th>
				<!--<th>CPU Usage</th>-->
				<th>Memory</th>
				<th>Disk</th>
				<th>Network</th>
				<th>Address</th>
				<th>Uptime</th>
				<th>State</th>
			</thead>
			<tbody></tbody>
		</table>
	</script>
	<script type="text/template" id="tpl-vms-list-item" data-tag="tr">
		<%
		var start_time = Date.parse(metrics.start_time) / 1000;
		%>

		<td><%= link(name_label, ['vms', uuid]) %></td>
		<td><%= name_description %></td>
		<!--<td><%= progressBar(10, {'label': '10%'}) %></td>--><!-- @todo -->
		<td><%= (guest_metrics && guest_metrics.memory.used) // @todo RRDs
			? progressBar(100 * guest_metrics.memory.used / guest_metrics.memory.total)
			: formatSize(metrics.memory_actual) %></td>
		<td><%= VBDs.length %></td>
		<td><%= VIFs.length %></td>
		<td><%= '@todo' || _.values(networks).join(', ') %></td>
		<td><%= (0 < start_time)
			? formatDuration_fromNow(start_time)
			: '<div class="text-center muted"><em>N/A</em></div>' %></td>
		<td><%= powerState() %></td>
	</script>

	<!-- VM. -->
	<script type="text/template" id="tpl-vm" data-class="container well" data-items-container=".tab-content">
		<h3 class="center"><%= name_label %></h3>

		<!-- Tabs menu. -->
		<ul class="nav nav-tabs">
			<li class="active"><a href="#general"><i class="icon-home"></i> General</a></li>
			<li><a href="#cpu"><i class="icon-dashboard"></i> CPU</a></li>
			<li><a href="#memory"><i class="icon-tasks"></i> Memory</a></li>
			<li><a href="#storage"><i class="icon-hdd"></i> Storage</a></li>
			<li><a href="#network"><i class="icon-sitemap"></i> Network</a></li>
			<li class="dropdown">
				<a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="icon-cog"></i> Misc <b class="caret"></b></a>
				<ul class="dropdown-menu">
					<li><a href="#console"><i class="icon-desktop"></i> Console</a></li>
					<!-- @todo<li><a href="#perfs"><i class="icon-bar-chart"></i> Perfs</a></li>
					<li><a href="#alerts"><i class="icon-bullhorn"></i> Alerts</a></li>-->
					<li><a href="#snapshots"><i class="icon-camera"></i> Snapshots</a></li>
					<li><a href="#logs"><i class="icon-comment"></i> Logs</a></li>
					<li><a href="#other"><i class="icon-asterisk"></i> Other</a></li>
				</ul>
			</li>
		</ul>

		<div class="tab-content"></div>
	</script>
	<script type="text/template" id="tpl-vm-general" data-class="tab-pane fade in active" data-id="general">
		<dl class="dl-horizontal">
			<dt>State:</dt>
			<dd><span class="label label-<%
			var state_to_colors = {
				'Running': 'success',
				'Paused':  'info',
				'Halted':  'important',
			};
			%><%= state_to_colors[power_state] %>"><%= power_state %></span></dd>
			<dt>Name:</dt>
			<dd><%= name_label %></dd>
			<dt>Description:</dt>
			<dd><%= name_description || '<em>none</em>' %></dd>
			<dt>Tags:</dt>
			<dd><%= tags.length ? tags.join(', ') : '<em>none</em>' %></dd>
			<!-- @todo
			<dt>Folder:</dt>
			<dd>-</dd>-->
			<dt>Operating system:</dt>
			<dd><%= (guest_metrics && guest_metrics.os_version)
				? guest_metrics.os_version.name
				: '<i>unknown</i>' %></dd>
			<!-- @todo
			<dt>BIOS string copier:</dt>
			<dd>No</dd>-->
			<dt>Virtualization state:</dt>
			<dd><%
			if (guest_metrics && guest_metrics.PV_drivers_up_to_date)
				%><span class="label label-success">Optimized</span><%
			else
				%><span class="label label-important">Not optimized</span><%
			%></dd>
			<dt>Uptime:</dt>
			<dd><%= metrics.start_time
				? formatDuration_fromNow(Date.parse(metrics.start_time)/1000)
				: 'N/A' %></dd>
			<dt>Host:</dt>
			<dd><% if (host)
			{
				%><%= link(host.name_label, ['hosts', host.uuid]) %><%
			}
			else
			{
				%><i>none</i><%
			} %></dd>
			<dt>UUID:</dt>
			<dd><%= uuid %></dd>
		</dl>
		<dl class="dl-horizontal">
			<dt>OS boot parameters:</dt>
			<dd><%= HVM_boot_params.length ? HVM_boot_params.join(" ") : "<i>none</i>" %></dd>
		</dl>
	</script>
	<script type="text/template" id="tpl-vm-cpu" data-class="tab-pane fade" data-id="cpu">
		<dl class="dl-horizontal">
			<dt>Number of VCPUs:</dt>
			<dd><%= metrics.VCPUs_number %></dd>
		</dl>
	</script>
	<script type="text/template" id="tpl-vm-memory" data-class="tab-pane fade" data-id="memory">
		<!-- @todo
		<div class="progress progress-big progress-danger">
			<div class="bar bar-info" style="width: 100%;">vmdb1<br/>(1024M)</div>
		</div> -->
		<dl class="dl-horizontal">
			<dt>Used memory:</dt>
			<dd><%= memory.used || "<i>not available</i>" %></dt>
			<dt>Total memory:</dt>
			<dd>
				<%= formatSize(memory.total) %>
				(min: <%= formatSize(memory_dynamic_min) %>,
				 max: <%= formatSize(memory_dynamic_max) %>)
			</dd>
		</dl>
	</script>
	<script type="text/template" id="tpl-vm-storage" data-class="tab-pane fade" data-id="storage">
		<h2>@todo</h2>
		<table class="table table-hover table-condensed">
			<thead>
				<tr>
					<th>Position</th>
					<th>Name</th>
					<th>Description</th>
					<th>SR</th>
					<th>Size</th>
					<th>Read only</th>
					<th>Priority</th>
					<th>Active</th>
					<th>Device path</th>
				</tr>
			</thead>
			<tbody><% for (var i = 0; i < VBDs.length; ++i)
			{
				var VBD = VBDs[i];
				%><tr>
					<td><i class="icon-hdd"></i> <%= i %></td>
					<td><%= VBD.name %></td>
					<td><%= VBD.description %></td>
					<td><%= VBD.SR_name %></td>
					<td><%= formatSize(VBD.size) %></td>
					<td><%= VBD.read_only ? 'Yes' : 'No' %></td>
					<td><%= VBD.priority %></td>
					<td><% if (VBD.currently_attached)
					{
						%><span class="label label-success">Yes</span><%
					}
					else
					{
						%><span class="label label-important">No</span><%
					} %></td>
					<td><%= VBD.path %></td>
				</tr><%
			} %>
			</tbody>
		</table>
	</script>
	<script type="text/template" id="tpl-vm-network" data-class="tab-pane fade" data-id="network">
		<h2>@todo</h2>
		<table class="table table-hover table-condensed">
			<thead>
				<tr>
					<th>Device</th>
					<th>MAC</th>
					<th>Limit</th>
					<th>Network</th>
					<th>IP address</th>
					<th>Active</th>
				</tr>
			</thead>
			<tbody>
			<% for (var i = 0; i < VIFs.length; ++i)
			{
				var VIF = VIFs[i];
				%><tr>
					<td><i class="icon-sitemap"></i> <%= i %></td>
					<td class="mac-address"><%= VIF.MAC %></td>
					<td>-</td> <!-- @todo -->
					<td><%= VIF.network_name || '<i>unknown</i>' %></td>
					<td><%= VIF.ip %></td>
					<td><% if (VIF.currently_attached)
					{
						%><span class="label label-success">Yes</span><%
					}
					else
					{
						%><span class="label label-important">No</span><%
					} %></td>
				</tr><% ;
			} %>
			</tbody>
		</table>
	</script>
	<script type="text/template" id="tpl-vm-console" data-class="tab-pane fade center" data-id="console">
		<h2>@todo</h2>
		<canvas width="640" height="480">
			Sorry, your browser does not support the canvas element.
		</canvas>
	</script>
	<script type="text/template" id="tpl-vm-snapshots" data-class="tab-pane fade" data-id="snapshots">
		<table class="table table-hover table-condensed">
			<thead>
				<tr>
					<th>Snapshot name</th>
					<th>Origin</th>
					<th>Date</th>
				</tr>
			</thead>
			<tbody><% for (var i = 0; i < snapshots.length; ++i)
			{
				var snapshot = snapshots[i];
				var date = moment.unix(snapshot.time).format('LLLL');
				%><tr>
					<td><i class="icon-camera"></i> <%= snapshot.name %></td>
					<td><%= link(snapshot.origin_name, ['vms', snapshot.origin_uuid]) %></td>
					<td><%= date %></td>
				</tr><%
			} %></tr>
			</tbody>
		</table>
	</script>
	<script type="text/template" id="tpl-vm-logs" data-class="tab-pane fade" data-id="logs">
		<table class="table table-hover table-condensed">
			<thead>
				<tr>
					<th>Event name</th>
					<th>Details</th>
					<th>Date</th>
					<th>Time</th>
				</tr>
			</thead>
			<tbody><% for (var i = 0; i < messages.length; ++i)
			{
				var msg = messages[i];
				var date = moment.unix(msg.time).format('LLLL');
				%><tr>
					<td><i class="icon-comment"></i> <%= msg.name %></td>
					<td><%= msg.body %></td>
					<td><%= date %></td>
					<td>00:10:16</td><!-- todo -->
				</tr><%
			} %></tbody>
		</table>
	</script>
	<script type="text/template" id="tpl-vm-other" data-class="tab-pane fade" data-id="other">
		<dl class="dl-horizontal">
			<dt>Preferred host:</dt>
			<dd><%
			if (!preferred_host)
			{
				%><i>none</i><%
			}
			else if (preferred_host.name_label)
			{
				%><%= link(preferred_host.name_label, ['hosts', preferred_host.uuid]) %><%
			}
			else
			{
				%><i>unknown host with opaque reference <%= preferred_host.ref %></i><%
			}
			%></dd>
		</dl>
	</script>

	<!-- Networks list. -->
	<script type="text/template" id="tpl-networks-list" data-class="container" data-items-container="tbody">

		<table class="table table-hover table-bordered">
			<thead>
				<tr>
				<th>Name</th>
				<th>Speed</th>
				<th>Duplex</th>
				<th>IP</th>
				<th>MAC</th>
				<th>Hardware</th>
				<th>Link status</th>
				</tr>
			</thead>
			<tbody></tbody>
		</table>
	</script>
	<script type="text/template" id="tpl-networks-list-item" data-tag="tr">
		<td><i class="icon-sitemap"></i> <%= name %></td>
		<td><%= '@todo' || speed %></td>
		<td><%= yesNo(duplex) %></td>
		<td><%= IP ? IP : '<em>none</em>' %></td>
		<td class="mac-address"><%= MAC %></td>
		<td><%= vendor %> <%= device %></td>
		<td><%= linkState() %></td>
	</script>

	<!-- Storages list. -->
	<script type="text/template" id="tpl-storages-list" data-class="container" data-items-container="tbody">
		<%
		if (name_label)
		{%>
			<h3 class="center"><%= link(name_label, ['pools', uuid]) %></h3>
		<%}
		%>

		<table class="table table-hover table-bordered">
			<thead>
				<tr>
				<th>Name</th>
				<th>Description</th>
				<th>Type</th>
				<th>Shared</th>
				<th>Usage</th>
				<th>Allocated</th>
				<th>Size</th>
				</tr>
			</thead>
			<tbody></tbody>
		</table>
	</script>
	<script type="text/template" id="tpl-storages-list-item" data-tag="tr">
		<%
		var allocated = +virtual_allocation;
		var total = +physical_size;
		var used = +physical_utilisation;
		%>

		<td><i class="icon-hdd"></i> <%= name_label %></td>
		<td><%= name_description %></td>
		<td><%= type %></td>
		<td><%= yesNo(shared) %></td>
		<%
		if (total > 0)
		{%>
			<td><div title="<%= formatSize(used) %>" class="text-center">
				<%= Math.round(100*used/total) %>%
			</div></td>
			<td><div title="<%= formatSize(allocated) %>" class="text-center">
				<%= Math.round(100*allocated/total) %>%
			</div></td>
			<td><div class="text-center"><%= formatSize(total) %></div></td>
		<%}
		else if (total === 0)
		{%>
			<td colspan="3"><div class="text-center muted"><em>Empty</em></div></td>
		<%}
		else
		{%>
			<td colspan="3"><div class="text-center muted"><em>N/A</em></div></td>
		<%}
		%>
	</script>

	<!-- Templates list. -->
	<script type="text/template" id="tpl-templates-list" data-class="container" data-items-container="tbody">
		<%
		if (name_label)
		{%>
			<h3 class="center"><%= link(name_label, ['pools', uuid]) %></h3>
		<%}
		%>

		<table class="table table-hover table-bordered">
			<thead>
				<tr>
				<th>Name</th>
				<th>Description</th>
				</tr>
			</thead>
			<tbody></tbody>
		</table>
	</script>
	<script type="text/template" id="tpl-templates-list-item" data-tag="tr">
		<td><i class="icon-file-alt"></i> <%= name_label %></td>
		<td><%= name_description %></td>
	</script>

	<!--==============================================================
	 = JavaScript files.
	 ==============================================================-->

	<!-- Underscore.js (data manipulation). -->
	<script src="js/underscore.js"></script>

	<!-- jQuery (document manipulation). -->
	<script src="./js/jquery.js"></script>

	<!-- Backbone.js (MVC library). -->
	<script src="./js/backbone.js"></script>

	<!-- Marionette.js (framework based on Backbone.js). -->
	<script src="js/marionette.js"></script>

	<!-- Backbone.Subset (subset collections for Backbone.js). -->
	<script src="./js/backbone.subset.js"></script>

	<!-- Moment.js (dates manipulation and display). -->
	<script src="./js/moment.js"></script>

	<!-- Bootstrap (various script related to the Bootstrap UI). -->
	<script src="./js/bootstrap.js"></script>

	<!-- Template helpers (@todo move into xo.js). -->
	<script src="./js/xo.helpers.js"></script>

	<!-- Q (promises library). -->
	<script src="./js/q.js"></script>

	<!-- XO-Web application. -->
	<script src="./js/xo.js"></script>

	<!-- NoVNC (script loader). -->
	<script src="./js/novnc/base64.js"></script>
	<script src="./js/novnc/display.js"></script>
	<script src="./js/novnc/input.js"></script>
	<script src="./js/novnc/jsunzip.js"></script>
	<script src="./js/novnc/rfb.js"></script>
	<script src="./js/novnc/util.js"></script>
	<script src="./js/novnc/websock.js"></script>
</body>

 </html>
